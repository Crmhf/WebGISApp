var VSHADER_SOURCE="attribute vec4 a_Position;\nattribute vec4 a_Normal;\nuniform mat4 u_MvpMatrix;\nuniform mat4 u_NormalMatrix;\nvarying vec4 v_Color;\nvoid main() {\n  gl_Position = u_MvpMatrix * a_Position;\n  vec3 lightDirection = normalize(vec3(0.0, 0.5, 0.7));\n  vec4 color = vec4(1.0, 0.4, 0.0, 1.0);\n  vec3 normal = normalize((u_NormalMatrix * a_Normal).xyz);\n  float nDotL = max(dot(normal, lightDirection), 0.0);\n  v_Color = vec4(color.rgb * nDotL + vec3(0.1), color.a);\n}\n";var FSHADER_SOURCE="#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec4 v_Color;\nvoid main() {\n  gl_FragColor = v_Color;\n}\n";function main(){var b=document.getElementById("webgl");var f=getWebGLContext(b);if(!f){console.log("Failed to get the rendering context for WebGL");return}if(!initShaders(f,VSHADER_SOURCE,FSHADER_SOURCE)){console.log("Failed to intialize shaders.");return}var g=initVertexBuffers(f);if(g<0){console.log("Failed to set the vertex information");return}f.clearColor(0,0,0,1);f.enable(f.DEPTH_TEST);var e=f.getAttribLocation(f.program,"a_Position");var d=f.getUniformLocation(f.program,"u_MvpMatrix");var a=f.getUniformLocation(f.program,"u_NormalMatrix");if(e<0||!d||!a){console.log("Failed to get the storage location of attribute or uniform variable");return}var c=new Matrix4();c.setPerspective(50,b.width/b.height,1,100);c.lookAt(20,10,30,0,0,0,0,1,0);document.onkeydown=function(h){keydown(h,f,g,c,e,d,a)};draw(f,g,c,e,d,a)}var ANGLE_STEP=3;var g_arm1Angle=90;var g_joint1Angle=45;var g_joint2Angle=0;var g_joint3Angle=0;function keydown(e,g,f,d,c,b,a){switch(e.keyCode){case 40:if(g_joint1Angle<135){g_joint1Angle+=ANGLE_STEP}break;case 38:if(g_joint1Angle>-135){g_joint1Angle-=ANGLE_STEP}break;case 39:g_arm1Angle=(g_arm1Angle+ANGLE_STEP)%360;break;case 37:g_arm1Angle=(g_arm1Angle-ANGLE_STEP)%360;break;case 90:g_joint2Angle=(g_joint2Angle+ANGLE_STEP)%360;break;case 88:g_joint2Angle=(g_joint2Angle-ANGLE_STEP)%360;break;case 86:if(g_joint3Angle<60){g_joint3Angle=(g_joint3Angle+ANGLE_STEP)%360}break;case 67:if(g_joint3Angle>-60){g_joint3Angle=(g_joint3Angle-ANGLE_STEP)%360}break;default:return}draw(g,f,d,c,b,a)}var g_baseBuffer=null;var g_arm1Buffer=null;var g_arm2Buffer=null;var g_palmBuffer=null;var g_fingerBuffer=null;function initVertexBuffers(e){var a=new Float32Array([5,2,5,-5,2,5,-5,0,5,5,0,5,5,2,5,5,0,5,5,0,-5,5,2,-5,5,2,5,5,2,-5,-5,2,-5,-5,2,5,-5,2,5,-5,2,-5,-5,0,-5,-5,0,5,-5,0,-5,5,0,-5,5,0,5,-5,0,5,5,0,-5,-5,0,-5,-5,2,-5,5,2,-5]);var c=new Float32Array([1.5,10,1.5,-1.5,10,1.5,-1.5,0,1.5,1.5,0,1.5,1.5,10,1.5,1.5,0,1.5,1.5,0,-1.5,1.5,10,-1.5,1.5,10,1.5,1.5,10,-1.5,-1.5,10,-1.5,-1.5,10,1.5,-1.5,10,1.5,-1.5,10,-1.5,-1.5,0,-1.5,-1.5,0,1.5,-1.5,0,-1.5,1.5,0,-1.5,1.5,0,1.5,-1.5,0,1.5,1.5,0,-1.5,-1.5,0,-1.5,-1.5,10,-1.5,1.5,10,-1.5]);var b=new Float32Array([2,10,2,-2,10,2,-2,0,2,2,0,2,2,10,2,2,0,2,2,0,-2,2,10,-2,2,10,2,2,10,-2,-2,10,-2,-2,10,2,-2,10,2,-2,10,-2,-2,0,-2,-2,0,2,-2,0,-2,2,0,-2,2,0,2,-2,0,2,2,0,-2,-2,0,-2,-2,10,-2,2,10,-2]);var f=new Float32Array([1,2,3,-1,2,3,-1,0,3,1,0,3,1,2,3,1,0,3,1,0,-3,1,2,-3,1,2,3,1,2,-3,-1,2,-3,-1,2,3,-1,2,3,-1,2,-3,-1,0,-3,-1,0,3,-1,0,-3,1,0,-3,1,0,3,-1,0,3,1,0,-3,-1,0,-3,-1,2,-3,1,2,-3]);var g=new Float32Array([0.5,2,0.5,-0.5,2,0.5,-0.5,0,0.5,0.5,0,0.5,0.5,2,0.5,0.5,0,0.5,0.5,0,-0.5,0.5,2,-0.5,0.5,2,0.5,0.5,2,-0.5,-0.5,2,-0.5,-0.5,2,0.5,-0.5,2,0.5,-0.5,2,-0.5,-0.5,0,-0.5,-0.5,0,0.5,-0.5,0,-0.5,0.5,0,-0.5,0.5,0,0.5,-0.5,0,0.5,0.5,0,-0.5,-0.5,0,-0.5,-0.5,2,-0.5,0.5,2,-0.5]);var h=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1]);var i=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);g_baseBuffer=initArrayBufferForLaterUse(e,a,3,e.FLOAT);g_arm1Buffer=initArrayBufferForLaterUse(e,c,3,e.FLOAT);g_arm2Buffer=initArrayBufferForLaterUse(e,b,3,e.FLOAT);g_palmBuffer=initArrayBufferForLaterUse(e,f,3,e.FLOAT);g_fingerBuffer=initArrayBufferForLaterUse(e,g,3,e.FLOAT);if(!g_baseBuffer||!g_arm1Buffer||!g_arm2Buffer||!g_palmBuffer||!g_fingerBuffer){return -1}if(!initArrayBuffer(e,"a_Normal",h,3,e.FLOAT)){return -1}var d=e.createBuffer();if(!d){console.log("Failed to create the buffer object");return -1}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,d);e.bufferData(e.ELEMENT_ARRAY_BUFFER,i,e.STATIC_DRAW);return i.length}function initArrayBufferForLaterUse(e,d,b,c){var a=e.createBuffer();if(!a){console.log("Failed to create the buffer object");return null}e.bindBuffer(e.ARRAY_BUFFER,a);e.bufferData(e.ARRAY_BUFFER,d,e.STATIC_DRAW);a.num=b;a.type=c;return a}function initArrayBuffer(f,d,e,b,c){var a=f.createBuffer();if(!a){console.log("Failed to create the buffer object");return false}f.bindBuffer(f.ARRAY_BUFFER,a);f.bufferData(f.ARRAY_BUFFER,e,f.STATIC_DRAW);var g=f.getAttribLocation(f.program,d);if(g<0){console.log("Failed to get the storage location of "+d);return false}f.vertexAttribPointer(g,b,c,false,0,0);f.enableVertexAttribArray(g);return true}var g_modelMatrix=new Matrix4(),g_mvpMatrix=new Matrix4();function draw(g,d,i,b,c,h){g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);var f=2;g_modelMatrix.setTranslate(0,-12,0);drawSegment(g,d,g_baseBuffer,i,b,c,h);var e=10;g_modelMatrix.translate(0,f,0);g_modelMatrix.rotate(g_arm1Angle,0,1,0);drawSegment(g,d,g_arm1Buffer,i,b,c,h);var a=10;g_modelMatrix.translate(0,e,0);g_modelMatrix.rotate(g_joint1Angle,0,0,1);drawSegment(g,d,g_arm2Buffer,i,b,c,h);var j=2;g_modelMatrix.translate(0,a,0);g_modelMatrix.rotate(g_joint2Angle,0,1,0);drawSegment(g,d,g_palmBuffer,i,b,c,h);g_modelMatrix.translate(0,j,0);pushMatrix(g_modelMatrix);g_modelMatrix.translate(0,0,2);g_modelMatrix.rotate(g_joint3Angle,1,0,0);drawSegment(g,d,g_fingerBuffer,i,b,c,h);g_modelMatrix=popMatrix();g_modelMatrix.translate(0,0,-2);g_modelMatrix.rotate(-g_joint3Angle,1,0,0);drawSegment(g,d,g_fingerBuffer,i,b,c,h)}var g_matrixStack=[];function pushMatrix(a){var b=new Matrix4(a);g_matrixStack.push(b)}function popMatrix(){return g_matrixStack.pop()}var g_normalMatrix=new Matrix4();function drawSegment(f,g,b,e,d,c,a){f.bindBuffer(f.ARRAY_BUFFER,b);f.vertexAttribPointer(d,b.num,b.type,false,0,0);f.enableVertexAttribArray(d);g_mvpMatrix.set(e);g_mvpMatrix.multiply(g_modelMatrix);f.uniformMatrix4fv(c,false,g_mvpMatrix.elements);g_normalMatrix.setInverseOf(g_modelMatrix);g_normalMatrix.transpose();f.uniformMatrix4fv(a,false,g_normalMatrix.elements);f.drawElements(f.TRIANGLES,g,f.UNSIGNED_BYTE,0)};