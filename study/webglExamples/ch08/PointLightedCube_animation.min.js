var VSHADER_SOURCE="attribute vec4 a_Position;\nattribute vec4 a_Color;\nattribute vec4 a_Normal;\nuniform mat4 u_MvpMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\nuniform vec3 u_LightColor;\nuniform vec3 u_LightPosition;\nuniform vec3 u_AmbientLight;\nvarying vec4 v_Color;\nvoid main() {\n  gl_Position = u_MvpMatrix * a_Position;\n  vec3 normal = normalize(vec3(u_NormalMatrix * a_Normal));\n  vec4 vertexPosition = u_ModelMatrix * a_Position;\n  vec3 lightDirection = normalize(u_LightPosition - vec3(vertexPosition));\n  float nDotL = max(dot(normal, lightDirection), 0.0);\n  vec3 diffuse = u_LightColor * a_Color.rgb * nDotL;\n  vec3 ambient = u_AmbientLight * a_Color.rgb;\n  v_Color = vec4(diffuse + ambient, a_Color.a);\n}\n";var FSHADER_SOURCE="#ifdef GL_ES\nprecision mediump float;\n#endif\nvarying vec4 v_Color;\nvoid main() {\n  gl_FragColor = v_Color;\n}\n";function main(){var c=document.getElementById("webgl");var i=getWebGLContext(c);if(!i){console.log("Failed to get the rendering context for WebGL");return}if(!initShaders(i,VSHADER_SOURCE,FSHADER_SOURCE)){console.log("Failed to intialize shaders.");return}var d=initVertexBuffers(i);if(d<0){console.log("Failed to set the vertex information");return}i.clearColor(0,0,0,1);i.enable(i.DEPTH_TEST);var o=i.getUniformLocation(i.program,"u_ModelMatrix");var b=i.getUniformLocation(i.program,"u_MvpMatrix");var j=i.getUniformLocation(i.program,"u_NormalMatrix");var a=i.getUniformLocation(i.program,"u_LightColor");var p=i.getUniformLocation(i.program,"u_LightPosition");var g=i.getUniformLocation(i.program,"u_AmbientLight");if(!b||!j||!a||!p||!g){console.log("Failed to get the storage location");return}var k=new Matrix4();k.setPerspective(30,c.width/c.height,1,100);k.lookAt(6,6,14,0,0,0,0,1,0);i.uniform3f(a,1,1,1);i.uniform3f(p,2.3,4,3.5);i.uniform3f(g,0.2,0.2,0.2);var f=0;var m=new Matrix4();var l=new Matrix4();var e=new Matrix4();var h=function(){f=animate(f);m.setRotate(f,0,1,0);i.uniformMatrix4fv(o,false,m.elements);l.set(k).multiply(m);i.uniformMatrix4fv(b,false,l.elements);e.setInverseOf(m);e.transpose();i.uniformMatrix4fv(j,false,e.elements);i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);i.drawElements(i.TRIANGLES,d,i.UNSIGNED_BYTE,0);requestAnimationFrame(h,c)};h()}function initVertexBuffers(f){var c=new Float32Array([2,2,2,-2,2,2,-2,-2,2,2,-2,2,2,2,2,2,-2,2,2,-2,-2,2,2,-2,2,2,2,2,2,-2,-2,2,-2,-2,2,2,-2,2,2,-2,2,-2,-2,-2,-2,-2,-2,2,-2,-2,-2,2,-2,-2,2,-2,2,-2,-2,2,2,-2,-2,-2,-2,-2,-2,2,-2,2,2,-2]);var b=new Float32Array([1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0]);var d=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1]);var e=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);if(!initArrayBuffer(f,"a_Position",c,3,f.FLOAT)){return -1}if(!initArrayBuffer(f,"a_Color",b,3,f.FLOAT)){return -1}if(!initArrayBuffer(f,"a_Normal",d,3,f.FLOAT)){return -1}f.bindBuffer(f.ARRAY_BUFFER,null);var a=f.createBuffer();if(!a){console.log("Failed to create the buffer object");return false}f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a);f.bufferData(f.ELEMENT_ARRAY_BUFFER,e,f.STATIC_DRAW);return e.length}function initArrayBuffer(f,d,e,b,c){var a=f.createBuffer();if(!a){console.log("Failed to create the buffer object");return false}f.bindBuffer(f.ARRAY_BUFFER,a);f.bufferData(f.ARRAY_BUFFER,e,f.STATIC_DRAW);var g=f.getAttribLocation(f.program,d);if(g<0){console.log("Failed to get the storage location of "+d);return false}f.vertexAttribPointer(g,b,c,false,0,0);f.enableVertexAttribArray(g);return true}var ANGLE_STEP=30;var g_last=Date.now();function animate(c){var b=Date.now();var a=b-g_last;g_last=b;var d=c+(ANGLE_STEP*a)/1000;return d%=360};