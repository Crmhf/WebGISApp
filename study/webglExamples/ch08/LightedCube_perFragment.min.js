var VSHADER_SOURCE="attribute vec4 a_Position;\nattribute vec4 a_Color;\nattribute vec4 a_Normal;\nuniform mat4 u_mvpMatrix;\nuniform mat4 u_normalMatrix;\nuniform vec3 u_LightDir;\nvarying vec4 v_Color;\nvarying float v_Dot;\nvoid main() {\n  gl_Position = u_mvpMatrix * a_Position;\n  v_Color = a_Color;\n  vec4 normal = u_normalMatrix * a_Normal;\n  v_Dot = max(dot(normalize(normal.xyz), u_LightDir), 0.0);\n}\n";var FSHADER_SOURCE="precision mediump float;\nvarying vec4 v_Color;\nvarying float v_Dot;\nvoid main() {\n  gl_FragColor = vec4(v_Color.xyz * v_Dot, v_Color.a);\n}\n";function main(){var b=document.getElementById("webgl");var g=getWebGLContext(b);if(!g){console.log("Failed to get the rendering context for WebGL");return}if(!initShaders(g,VSHADER_SOURCE,FSHADER_SOURCE)){console.log("Failed to intialize shaders.");return}var c=initVertexBuffers(g);if(c<0){console.log("Failed to initialize buffers");return}g.clearColor(0,0,0,1);g.enable(g.DEPTH_TEST);var l=g.getUniformLocation(g.program,"u_mvpMatrix");var j=g.getUniformLocation(g.program,"u_normalMatrix");var k=g.getUniformLocation(g.program,"u_LightDir");if(!l||!j||!k){console.log("Failed to get the storage location");return}var e=new Matrix4();var i=new Matrix4();var f=new Matrix4();var d=new Matrix4();e.setLookAt(0,3,10,0,0,0,0,1,0);f.set(e).rotate(60,0,1,0);i.setPerspective(30,1,1,100);i.multiply(f);d.setInverseOf(f);d.transpose();g.uniformMatrix4fv(l,false,i.elements);g.uniformMatrix4fv(j,false,d.elements);var a=new Vector3([1,1,1]);a.normalize();var h=e.multiplyVector3(a);h.normalize();g.uniform3fv(k,h.elements);g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);g.drawElements(g.TRIANGLES,c,g.UNSIGNED_BYTE,0)}function initVertexBuffers(f){var c=new Float32Array([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1]);var b=new Float32Array([1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0]);var d=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1]);var e=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);initArrayBuffer(f,c,3,"a_Position");initArrayBuffer(f,b,3,"a_Color");initArrayBuffer(f,d,3,"a_Normal");f.bindBuffer(f.ARRAY_BUFFER,null);var a=f.createBuffer();if(!a){console.log("Failed to create the buffer object");return false}f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,a);f.bufferData(f.ELEMENT_ARRAY_BUFFER,e,f.STATIC_DRAW);return e.length}function initArrayBuffer(e,d,b,c){var a=e.createBuffer();if(!a){console.log("Failed to create the buffer object");return false}e.bindBuffer(e.ARRAY_BUFFER,a);e.bufferData(e.ARRAY_BUFFER,d,e.STATIC_DRAW);var f=e.getAttribLocation(e.program,c);if(f<0){console.log("Failed to get the storage location of "+c);return false}e.vertexAttribPointer(f,3,e.FLOAT,false,0,0);e.enableVertexAttribArray(f);return true};